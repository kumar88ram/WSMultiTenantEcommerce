<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewModels="clr-namespace:MultiTenantEcommerce.Maui.ViewModels"
             xmlns:models="clr-namespace:MultiTenantEcommerce.Maui.Models"
             xmlns:converters="clr-namespace:MultiTenantEcommerce.Maui.Converters"
             x:Class="MultiTenantEcommerce.Maui.Views.CheckoutPage"
             x:DataType="viewModels:CheckoutViewModel"
             Title="Checkout">
    <ContentPage.Resources>
        <converters:InverseBooleanConverter x:Key="InverseBooleanConverter" />
    </ContentPage.Resources>
    <ScrollView>
        <VerticalStackLayout Padding="16" Spacing="20">
            <Label Text="Shipping address" FontAttributes="Bold" />
            <Picker ItemsSource="{Binding Addresses}" ItemDisplayBinding="{Binding Label}" SelectedItem="{Binding SelectedAddress}" />

            <Label Text="Shipping method" FontAttributes="Bold" />
            <Picker ItemsSource="{Binding ShippingOptions}" ItemDisplayBinding="{Binding Name}" SelectedItem="{Binding SelectedShippingOption}" />

            <Frame Padding="16" CornerRadius="18" BackgroundColor="White" HasShadow="True">
                <VerticalStackLayout Spacing="8">
                    <Grid ColumnDefinitions="*,Auto">
                        <Label Text="Subtotal" />
                        <Label Text="{Binding Subtotal, StringFormat='${0:F2}'}" />
                    </Grid>
                    <Grid ColumnDefinitions="*,Auto">
                        <Label Text="Taxes" />
                        <Label Text="{Binding Taxes, StringFormat='${0:F2}'}" />
                    </Grid>
                    <Grid ColumnDefinitions="*,Auto">
                        <Label Text="Shipping" />
                        <Label Text="{Binding ShippingFee, StringFormat='${0:F2}'}" />
                    </Grid>
                    <Grid ColumnDefinitions="*,Auto">
                        <Label Text="Total" FontAttributes="Bold" />
                        <Label Text="{Binding GrandTotal, StringFormat='${0:F2}'}" FontAttributes="Bold" />
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <Button Text="Place order" Command="{Binding PlaceOrderCommand}" Style="{StaticResource PrimaryButtonStyle}" IsEnabled="{Binding IsProcessing, Converter={StaticResource InverseBooleanConverter}}" />
            <ActivityIndicator IsRunning="{Binding IsProcessing}" IsVisible="{Binding IsProcessing}" />
            <Label Text="{Binding PaymentStatusMessage}" HorizontalOptions="Center" />
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
